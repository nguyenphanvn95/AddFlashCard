var e,t;"function"==typeof(e=globalThis.define)&&(t=e,e=null),function(t,n,o,i,r){var c="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},a="function"==typeof c[i]&&c[i],d=a.cache||{},l="undefined"!=typeof module&&"function"==typeof module.require&&module.require.bind(module);function u(e,n){if(!d[e]){if(!t[e]){var o="function"==typeof c[i]&&c[i];if(!n&&o)return o(e,!0);if(a)return a(e,!0);if(l&&"string"==typeof e)return l(e);var r=Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}m.resolve=function(n){var o=t[e][1][n];return null!=o?o:n},m.cache={};var s=d[e]=new u.Module(e);t[e][0].call(s.exports,m,s,s.exports,this)}return d[e].exports;function m(e){var t=m.resolve(e);return!1===t?{}:u(t)}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=t,u.cache=d,u.parent=a,u.register=function(e,n){t[e]=[function(e,t){t.exports=n},{}]},Object.defineProperty(u,"root",{get:function(){return c[i]}}),c[i]=u;for(var s=0;s<n.length;s++)u(n[s]);if(o){var m=u(o);"object"==typeof exports&&"undefined"!=typeof module?module.exports=m:"function"==typeof e&&e.amd?e(function(){return m}):r&&(this[r]=m)}}({kgW6q:[function(e,t,n){e("../../../src/background")},{"../../../src/background":"fx8Od"}],fx8Od:[function(e,t,n){var o=e("./utils/inject");function i(e){return new Promise((t,n)=>{chrome.tabs.captureVisibleTab(null,{format:"png"},o=>{let i=chrome.runtime.lastError;if(i)return n(i);if(!e)return fetch(o).then(e=>e.blob()).then(t,n);let r=e.left*e.devicePixelRatio,c=e.top*e.devicePixelRatio,a=e.width*e.devicePixelRatio,d=e.height*e.devicePixelRatio,l=new OffscreenCanvas(a,d),u=l.getContext("2d");fetch(o).then(e=>e.blob()).then(async e=>{let n=await createImageBitmap(e);a&&d?u.drawImage(n,r,c,a,d,0,0,a,d):u.drawImage(n,0,0),t(await l.convertToBlob({type:"image/png",quality:.99}))}).catch(n)})})}function r(e,t){"[date] - [time] - [title]".replace("[title]",t.title).replace("[date]",new Intl.DateTimeFormat("en-CA").format()).replace("[time]",new Intl.DateTimeFormat("en-CA",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).format());let n=new FileReader;n.onload=()=>{var e,o;e={cmd:"mycap",value:n.result,title:t.title},o=function(e){console.log("res contents info: "+e)},chrome.tabs.query({active:!0,currentWindow:!0},function(t){chrome.tabs.sendMessage(t[0].id,e,function(e){o&&o(e)})})},n.readAsDataURL(e)}{let e=()=>{chrome.contextMenus.create({id:"capture-portion",title:"Capture a Portion",contexts:["page","selection","link"]}),chrome.contextMenus.create({id:"capture-visual",title:"Capture Visual Part",contexts:["page","selection","link"]})};chrome.runtime&&chrome.runtime.onInstalled?chrome.runtime.onInstalled.addListener(e):e()}function c(e,t){"capture-visual"===e?i().then(e=>r(e,t)).catch(e=>{console.warn(e)}):"capture-portion"===e?chrome.scripting.insertCSS({target:{tabId:t.id},css:'.itrisearch-box {all: initial;box-sizing: border-box;position: fixed;z-index: 2147483646;border: gray 1px dotted;box-shadow: 0 0 0 50000px rgba(0, 0, 0, 0.2);background-color: transparent;}.itrisearch-box::before {content:"";display: block;width: calc(100% + 20px);height: calc(100% + 20px);margin-left: -10px;margin-top: -10px;cursor: crosshair;}.itrisearch-guide-1, .itrisearch-guide-2 {all: initial;background-color: transparent;box-sizing: border-box;position: fixed;z-index: 2147483646;}.itrisearch-guide-1 {border-right: dashed 1px gray;top: 0;left: 0;height: 100%;}.itrisearch-guide-2 {border-bottom: dashed 1px gray;top: 0;left: 0;width: 100%;}.itrisearch-guide-3 {all: initial;background: transparent;z-index: 2147483645;position: fixed;top: 0;left: 0;width: 100%;height: 100%;}'},()=>{let e=chrome.runtime.lastError;e&&console.log("lastError",e),chrome.scripting.executeScript({target:{tabId:t.id},func:o.myinject},()=>{console.log("Background script got callback after injection")})}):"capture-entire"===e&&console.log("not surport...")}chrome.contextMenus.onClicked.addListener((e,t)=>{c(e.menuItemId,t)}),chrome.runtime.onMessage.addListener((e,t,n)=>{"captured"===e.method&&i(e).then(e=>r(e,t.tab)).catch(e=>{console.warn(e)}),"popup"===e.method&&(c(e.cmd,e.ta),n(!0))})},{"./utils/inject":"bO2hz"}],bO2hz:[function(e,t,n){var o=e("@parcel/transformer-js/src/esmodule-helpers.js");function i(){var e=window.monitor,t=window.capture,n=window.guide;try{n.remove(),t.remove(),e.remove()}catch(e){}t=function(){let o,i,r,c,a,d,l;function u(e){c=e.clientX>i?i:e.clientX-1,a=e.clientY>r?r:e.clientY-1,d=Math.abs(e.clientX-i),l=Math.abs(e.clientY-r),o.style.left=c+"px",o.style.top=a+"px",o.style.width=d+"px",o.style.height=l+"px"}function s(){chrome.runtime.sendMessage({method:"captured",left:c+1,top:a+1,width:d-2,height:l-2,devicePixelRatio:window.devicePixelRatio,title:document.title,service:window.service}),n.remove(),t.remove(),e.remove()}function m(e){e.stopPropagation(),e.preventDefault(),(o=document.createElement("div")).setAttribute("class","itrisearch-box"),i=e.clientX,r=e.clientY,document.addEventListener("mousemove",u,!1),document.addEventListener("mouseup",s,!1),document.body.appendChild(o)}return{install:function(){document.addEventListener("mousedown",m,!1)},remove:function(){document.removeEventListener("mousedown",m,!1),document.removeEventListener("mousemove",u,!1),document.removeEventListener("mouseup",s,!1),o&&o.parentNode&&o.parentNode.removeChild(o)}}}(),n=function(){let e,n,o;function i(t){var o,i;o=t.clientX,i=t.clientY,e.style.width=o+"px",n.style.height=i+"px"}return{install:function(){e=document.createElement("div"),n=document.createElement("div"),o=document.createElement("div"),e.setAttribute("class","itrisearch-guide-1"),n.setAttribute("class","itrisearch-guide-2"),o.setAttribute("class","itrisearch-guide-3"),document.body.appendChild(o),document.body.appendChild(e),document.body.appendChild(n),document.addEventListener("mousemove",i,!1)},remove:function(){document.removeEventListener("mousemove",i,!1),e&&e.parentNode&&e.parentNode.removeChild(e),n&&n.parentNode&&n.parentNode.removeChild(n),o&&o.parentNode&&o.parentNode.removeChild(o),t.remove()}}}(),e=function(){function o(o){27===o.keyCode&&(n.remove(),t.remove(),e.remove())}return{install:function(){window.addEventListener("keydown",o,!1)},remove:function(){window.removeEventListener("keydown",o,!1)}}}(),n.install(),t.install(),e.install()}o.defineInteropFlag(n),o.export(n,"myinject",()=>i)},{"@parcel/transformer-js/src/esmodule-helpers.js":"f6DG4"}],f6DG4:[function(e,t,n){n.interopDefault=function(e){return e&&e.__esModule?e:{default:e}},n.defineInteropFlag=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.exportAll=function(e,t){return Object.keys(e).forEach(function(n){"default"===n||"__esModule"===n||t.hasOwnProperty(n)||Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[n]}})}),t},n.export=function(e,t,n){Object.defineProperty(e,t,{enumerable:!0,get:n})}},{}]},["kgW6q"],"kgW6q","parcelRequire8c5a"),globalThis.define=t;